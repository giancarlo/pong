!function(a,b){"use strict";a.in=function(b){return new a.in.Listener(b)},a.extend(a.in,{Modules:{},Listener:a.Class.extend({x:0,y:0,dx:0,dy:0,sx:1,sy:1,module:null,element:null,interval:60,intervalId:null,init:function(c){var d=this;("string"==typeof c||"object"==typeof c&&c.tagName)&&(c={element:c}),a.Class.apply(this,[c]),null===this.element?this.element=b.document:"string"==typeof this.element&&(this.element=a.id(this.element)),d.module={},d.poll=function(){d._poll()},d.calculate_bound=function(a){d._calculate_bound(a)},b.addEventListener("resize",this.calculate_bound),b.addEventListener("scroll",this.calculate_bound),this.intervalId=b.setInterval(this.poll,this.interval),this.calculate_bound();for(var e in a.in.Modules)d.module[e]=new a.in.Modules[e](d)},fire:function(a,b){return this.disabled||(b.j5g3in=this,b.name=a,this.on_fire&&this.on_fire(b)===!1)?void 0:this[a]?(b.preventDefault(),this[a](b)):void 0},_calculate_bound:function(){var a,c=this.element;c.getBoundingClientRect?(a=c.getBoundingClientRect(),this.bx=b.scrollX+a.left||0,this.by=b.scrollY+a.top||0):(this.bx=c.clientLeft||0,this.by=c.clientTop||0)},_poll:function(){if(this.disabled===!1)for(var a in this.module)this.module[a].update()},set_pos:function(a,b){a=a*this.sx-this.bx,b=b*this.sy-this.by,this.dx=a-this.x,this.dy=b-this.y,this.x=a,this.y=b},destroy:function(){this.disable(),b.removeEventListener("scroll",this.calculate_bound),b.removeEventListener("resize",this.calculate_bound),b.clearInterval(this.poll)},enable:function(){this.disabled=!1;for(var a in this.module)this.module[a].enable()},disable:function(){this.disabled=!0;for(var a in this.module)this.module[a].disable()}}),Module:a.Class.extend({handler:null,el:null,enabled:!1,_enable:null,_disable:null,init:function(a){this.handler={},this.listener=a,this.el=a.element,this.enable()},update:function(){},_on:function(a,b){var c=b.bind(this);this.handler[a]=c,this.el.addEventListener(a,c)},_un:function(a){this.el.removeEventListener(a,this.handler[a])},enable:function(){return this.enabled||(this._enable(),this.enabled=!0),this},disable:function(){return this.enabled&&(this._disable(),this.enabled=!1),this},destroy:function(){this.disable();for(var a in this.listener.module)if(this.listener.module[a]===this){delete this.listener.module[a];break}}})})}(this.j5g3,this),function(a){"use strict";a.in.Modules.Mouse=a.in.Module.extend({x_threshold:1,y_threshold:1,bx:0,by:0,capture_move:!0,_calculate_pos:function(a){this.listener.set_pos(a.pageX,a.pageY)},_click:function(a){var b={0:"buttonY",1:"buttonX",2:"buttonA"}[a.button];return this._calculate_pos(a),this.listener.fire(b,a),!1},_mousemove:function(a){this.capture_move&&(this._calculate_pos(a),(Math.abs(this.listener.dx)>this.x_threshold||Math.abs(this.listener.dy)>this.y_threshold)&&this.listener.fire("move",a))},_enable:function(){this._on("mousemove",this._mousemove),this._on("click",this._click),this._on("contextmenu",this._click)},_disable:function(){this._un("mousemove"),this._un("click"),this._un("contextmenu")}})}(this.j5g3,this),function(a){"use strict";a.in.Modules.Touch=a.in.Module.extend({x_threshold:20,y_threshold:20,flick_threshold:120,flick_delay:300,tap_delay:200,touches:null,move_type:"linear",radius:25,angle:0,_calculate_pos:function(a){this.listener.set_pos(a.pageX,a.pageY)},each_touch:function(a,b){for(var c,d,e=a.changedTouches,f=e.length;f--;)d=e[f].identifier,c=this.touches[d]||(this.touches[d]={id:d}),c.ev=a,c.touch=e[d],this._calculate_pos(e[f]),b(a,e[f],c,this)},update:function(){var a,b=this.touches;for(a in b)this.listener.set_pos(b[a].mx,b[a].my),this.listener.fire("buttonY",b[a].ev)},__touchmove:function(a,b,c,d){var e,f=d.listener.x,g=d.listener.y,h=f-c.mx,i=g-c.my;h<-d.x_threshold?(c.mx=f,e="left"):h>d.x_threshold&&(c.mx=f,e="right"),i<-d.y_threshold?(c.my=g,e="up"+(e?"_"+e:"")):i>d.y_threshold&&(c.my=g,e="down"+(e?"_"+e:"")),e&&(d.listener.fire(e,a),d.direction=e,d.listener.fire("move",a))},__touchradial:function(a,b,c,d){var e=d.listener.x,f=d.listener.y,g=c.tx-e,h=c.ty-f,i=e-c.pivotx,j=f-c.pivoty;(g>d.x_threshold||g<-d.x_threshold)&&(h>d.y_threshold||h<-d.y_threshold)&&(a.angle=Math.atan2(j,i),d.listener.fire("move",a))},_touchmove:function(a){this.each_touch(a,"linear"===this.move_type?this.__touchmove:this.__touchradial)},_flick_action:function(a,b){var c,d=this.listener.x,e=this.listener.y,f=d-b.tx,g=e-b.ty;f<-this.flick_threshold?c="buttonY":f>this.flick_threshold&&(c="buttonA"),g<-this.flick_threshold?c="buttonX":g>this.flick_threshold&&(c="buttonB"),c&&this.listener.fire(c,a)},set_pivot:function(a){a.pivotx=a.tx-Math.cos(this.angle)*this.radius,a.pivoty=a.ty-Math.sin(this.angle)*this.radius},__touchstart:function(a,b,c,d){c.touchstart_t=Date.now(),c.ev=a,c.tx=c.mx=d.listener.x,c.ty=c.my=d.listener.y,"radial"===d.move_type&&d.set_pivot(c)},_touchstart:function(a){this.each_touch(a,this.__touchstart)},__touchend:function(a,b,c,d){var e=Date.now()-c.touchstart_t;e<d.tap_delay?d.listener.fire("buttonY",a):e<d.flick_delay&&d._flick_action(a,c),delete d.touches[c.id]},_touchend:function(a){this.each_touch(a,this.__touchend)},_enable:function(){this._on("touchmove",this._touchmove),this._on("touchstart",this._touchstart),this._on("touchend",this._touchend),this.touches={}},_disable:function(){this._un("touchmove"),this._un("touchstart"),this._un("touchend")}})}(this.j5g3,this),function(a,b){"use strict";var c=b.document,d={32:"buttonB",13:"buttonY",16:"buttonX",17:"buttonA",37:"left",38:"up",39:"right",40:"down",105:"up_right",103:"up_left",99:"down_right",97:"down_left"};a.in.Modules.Keyboard=a.in.Module.extend({keymap:null,keys:null,_keydown:function(a){this.keys[a.keyCode]=a,this.keymap[a.keyCode]&&a.preventDefault()},init:function(b){this.keys={},a.in.Module.apply(this,[b]),null===this.keymap&&a.extend(this.keymap={},d)},_keyup:function(a){this.keys[a.keyCode]=!1},update:function(){var a,b,c;for(c in this.keymap)(b=this.keys[c])&&(a=this.keymap[c])&&(this.listener.fire(a,b),c>32&&(b.direction=a,this.listener.fire("move",b)))},_enable:function(){this.keys={},this.handler.keydown=this._keydown.bind(this),this.handler.keyup=this._keyup.bind(this),c.addEventListener("keydown",this.handler.keydown),c.addEventListener("keyup",this.handler.keyup)},_disable:function(){this.keys={},c.removeEventListener("keydown",this.handler.keydown),c.removeEventListener("keyup",this.handler.keyup)}})}(this.j5g3,this),function(a,b){"use strict";b.navigator.webkitGetGamepads&&(a.in.Modules.Joystick=a.in.Module.extend({_enable:function(){},_disable:function(){}}))}(this.j5g3,this);